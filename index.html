<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style>
      body {
        margin: 0;
      }
      .stage {
        margin: 10vw;
        width: 500px;
        height: 500px;
      }
    </style>
  </head>
  <body>
    <div class="stage"></div>
  </body>
  <script src="./src/index.js"></script>
  <script>
    let app = new Moa.App(document.querySelector(".stage"));
    let rect = app.Obj({
      x: 100,
      y: 100,
      w: 100,
      h: 100,
      draw: ctx => {
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(0, 0, 100, 100);
      }
    });

    let ifDrag = false;
    const p = {
      x: undefined,
      y: undefined
    };

    rect.on("mousemove", function(e) {
      if (ifDrag) {
        this.x += e.x - p.x;
        this.y += e.y - p.y;

        p.x = e.x;
        p.y = e.y;
      }
    });

    rect.on("click", function(e) {
      this.draw = ctx => {
        ctx.font = "20px Georgia";
        ctx.fillText("Hello World!", 10, 50);

        ctx.font = "30px Verdana";

        var gradient = ctx.createLinearGradient(0, 0, 100, 0);
        gradient.addColorStop("0", "magenta");
        gradient.addColorStop("0.5", "blue");
        gradient.addColorStop("1.0", "red");

        ctx.fillStyle = gradient;
        ctx.fillText("moa-interact", 10, 90);
      };
    });

    rect.on("mouseenter", function(e) {
      this.draw = ctx => {
        ctx.fillStyle = "#c0ebff";
        ctx.fillRect(0, 0, 100, 100);
      };
    });

    rect.on("mouseleave", function(e) {
      this.draw = ctx => {
        ctx.fillStyle = "#FFFFFF";
        ctx.strokeStyle = "#FF0000";
        ctx.fillRect(0, 0, 100, 100);
      };
    });

    rect.on("mousedown", function(e) {
      ifDrag = true;
      p.x = e.x;
      p.y = e.y;
    });

    rect.on("mouseup", function(e) {
      ifDrag = false;
    });

    let rect1 = app.Obj({
      x: 300,
      y: 300,
      r: 100,
      draw: function(ctx) {
        ctx.fillStyle = "#000000";
        ctx.arc(0, 0, this.r, 0, 2 * Math.PI);
        ctx.fill();
      }
    });

    let ifDrag1 = false;
    let p1 = {
      x: undefined,
      y: undefined
    };

    rect1.on("mousemove", function(e) {
      if (ifDrag1) {
        this.x += e.x - p1.x;
        this.y += e.y - p1.y;

        p1.x = e.x;
        p1.y = e.y;
      }
    });

    rect1.on("mousedown", function(e) {
      console.log("rect1");
      ifDrag1 = true;
      p1.x = e.x;
      p1.y = e.y;
    });

    rect1.on("mouseenter", function(e) {
      this.draw = function(ctx) {
        ctx.fillStyle = "#c0ebff";
        ctx.arc(0, 0, this.r, 0, 2 * Math.PI);
        ctx.fill();
      };
    });

    rect1.on("mouseleave", function(e) {
      this.draw = function(ctx) {
        ctx.fillStyle = "#000000";
        ctx.arc(0, 0, this.r, 0, 2 * Math.PI);
        ctx.fill();
      };
    });

    rect1.on("mouseup", function(e) {
      ifDrag1 = false;
    });

    app.run();
  </script>
</html>
